@using ModelCore.Schema.ENID
@model CDSLcdApplication

<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="Big5">
    <title>開發國內不可撤銷信用狀申請書</title>
    <style>
        .text {
            font-family: "標楷體";
        }
        .text-blue {
            color: #0000ff;
        }
    </style>
</head>
<body>
    <table width="100%" border="0" cellpadding="5" cellspacing="1" bgcolor="#000000" class="text">
        <tbody>
            <tr>
                <td colspan="3" valign="top" bgcolor="#FFFFFF">
                    <p class="MsoNormal" align="center">
                        <span style="font-family: 標楷體">
                            <font size="5">
                                <b>開發國內不可撤銷信用狀申請書</b>
                            </font>
                        </span>
                    </p>
                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
                        <tr>
                            <td class="text">
                                <div align="left">
                                    <font face="標楷體" size="4">
                                        <strong>@Model.lcDoc.issuingBank.name</strong>
                                    </font>
                                    <u>　@Model.lcDoc.issuingBank.branchName　</u>台鑑
                                </div>
                            </td>
                            <td class="text">
                                <div align="right">
                                    日期：民國
                                    <span class="text-blue">
                                        @(int.Parse(Model.lcAppInfo.appDate.Substring(0, 4)) - 1911)
                                    </span> 年
                                    <span class="text-blue">
                                        @Model.lcAppInfo.appDate.Substring(5, 2)
                                    </span> 月
                                    <span class="text-blue">
                                        @Model.lcAppInfo.appDate.Substring(8, 2)
                                    </span> 日
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr bgcolor="#FFFFFF">
                <td width="50%" valign="top" rowspan="3">
                    <p class="MsoNormal">
                        <span style="font-family: 新細明體">
                            <strong>茲請　貴行准照前訂委任開發國內信用狀契約之約定依下開條件開發信用狀。</strong>
                        </span>
                        <br />
                        <span style="font-family: 新細明體">
                            <strong>本信用狀規定如有未盡事宜適用國際商會所訂現行「信用狀統一慣例與實務」之規定。</strong>
                        </span>
                    </p>
                </td>
                <td width="25%" valign="top">
                    <span style="font-family: 新細明體">信用狀號碼：</span><br /><br /><br />
                    <span style="font-family: 新細明體">開證  日期：@Model.lcDoc.lcNo</span>
                </td>
                <td width="25%" valign="top">
                    <span style="font-family: 新細明體">通知銀行編號：</span>
                </td>
            </tr>
            <tr>
                <td colspan="2" bgcolor="#FFFFFF">
                    申請人：
                    <span class="text-blue">@Model.lcDoc.applicant.name</span>
                </td>
            </tr>
            <tr>
                <td colspan="2" bgcolor="#FFFFFF">
                    地址：
                    <span class="text-blue">@Model.lcDoc.applicant.address</span>
                </td>
            </tr>
            <tr>
                <td width="50%" bgcolor="#FFFFFF">
                    <div align="center">(如有需要指定銀行時請填上)</div>
                    <span style="font-family: 新細明體">通知銀行：</span>
                    <span style="font-family: 新細明體">@Model.lcDoc.advisingBank.name</span>
                    <u>
                        <span class="text-blue">@Model.lcDoc.advisingBank.branchName</span>
                    </u>
                </td>
                <td colspan="2" bgcolor="#FFFFFF">
                    金額：<strong>@Model.lcDoc.currency.name</strong>
                    <span class="text-blue">@Model.lcDoc.amount.chinese</span>
                </td>
            </tr>
            <tr>
                <td width="50%" bgcolor="#FFFFFF">
                    <span style="font-family: 新細明體">受益人：
                        <span class="text-blue">@Model.lcDoc.beneficiary.name</span>
                    </span>
                    <br />
                    <span style="font-family: 新細明體">地　址：
                        <span class="text-blue">@Model.lcDoc.beneficiary.address</span>
                    </span>
                    <br />
                    <span style="font-family: 新細明體">電　話：
                        <span class="text-blue">@Model.lcDoc.beneficiary.phone</span>
                    </span>
                </td>
                <td colspan="2" bgcolor="#FFFFFF">
                    有效期限至：民國
                    <span class="text-blue">
                        @(int.Parse(Model.lcDoc.expiryDate.Value.Substring(0, 4)) - 1911)
                    </span> 年
                    <span class="text-blue">
                        @Model.lcDoc.expiryDate.Value.Substring(5, 2)
                    </span> 月
                    <span class="text-blue">
                        @Model.lcDoc.expiryDate.Value.Substring(8, 2)
                    </span> 日止
                </td>
            </tr>
            <tr>
                <td width="100%" colspan="3" valign="center" bgcolor="#FFFFFF">
                    <p class="MsoNormal">
                        <span style="font-family: 新細明體">
                            <strong>本信用狀可由上開受益人在不超過上開金額範圍內，依本信用狀規定條件簽發匯票承兌╱付款：</strong>
                        </span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width="100%" colspan="3" valign="center" bgcolor="#FFFFFF">
                    <p class="MsoNormal">
                        <span style="font-family: 新細明體">
                            <strong>一、匯票之條件：</strong>
                        </span>
                    </p>
                    <p class="MsoNormal" style="margin-left: 24pt; text-indent: -24pt">
                        <blockquote>
                            甲、付款人：@Model.lcDoc.payingBank.name
                            <span class="text-blue">
                                <u>@Model.lcDoc.payingBank.branchName</u>
                            </span>
                            <br />
                            @if (Model.lcDoc.conditions.Any(c => c.name == "AtDaysAfterDate" && c.used == false)) {
                                <span>乙、付款期限：見票即付。</span>
                            }
                            @{
                                var condition = Model.lcDoc.conditions.FirstOrDefault(c => c.name == "AtDaysAfterDate" && c.used == true);
                            }
                            @if (condition != null) {
                                <span>乙、付款期限：以「定日付款」方式填寫到期日，其到期日自匯票發票日起算
                                    <span class="text-blue">
                                        <u>@condition.textBlank.blank.Value</u>
                                    </span>天。
                                </span>
                            }
                            <br />
                            丙、金額：須與相關發票上所開列金額一致或依照本信用狀其他指示。
                            <br />
                        </blockquote>
                    </p>
                </td>
            </tr>
            <tr>
                <td width="100%" colspan="3" valign="center" bgcolor="#FFFFFF">
                    <p class="MsoNormal">
                        <span style="font-family: 新細明體">
                            <strong>二、應檢附之單證如下：</strong>
                        </span>
                    </p>
                    <p class="MsoNormal" style="margin-left: 24pt; text-indent: -24pt">
                        <blockquote>
                            @{
                                condition = Model.lcDoc.conditions.Where(c => c.name == "PaymentTerm").FirstOrDefault();
                            }
                            @if (condition != null) 
                            {
                                <span>
                                    1. @(condition.singleChoice.Any(i => i.name == "Payment" && i.@checked == true) ? "■" : "□")匯票付款申請書乙份。
                                    @(condition.singleChoice.Any(i => i.name == "Acceptance" && i.@checked == true) ? "■" : "□")匯票承兌申請書乙份。
                                </span>
                                <br />
                                @foreach (var condition in Model.lcDoc.conditions.Where(c => c.name == "Invoice"))
                                    <span>
                                        2. @(condition.used ? "■" : "□")統一發票。
                                    </span>
                                    <br />
                                }
                                @foreach (var condition in Model.lcDoc.conditions.Where(c => c.name == "OtherAppendix" && c.used == true)) {
                                    <span>
                                        3. ■其　　他
                                        <blockquote>
                                            <pre>
                                                <span class="text-blue">@condition.textArea.FirstOrDefault(a => a.name == "OtherAppendix")?.Value</span>
                                            </pre>
                                        </blockquote>
                                    </span>
                                    <br />
                                }
                            }
                            @if (Model.lcDoc.conditions.Any(c => c.name == "PaymentTerm" && c.singleChoice.Any(i => i.name == "Usance" && i.@checked == true))) {
                                @foreach (var condition in Model.lcDoc.conditions.Where(c => c.name == "DraftPaymentOrAcceptanceApplication")) {
                                    <span>
                                        1. @(condition.singleChoice.Any(i => i.name == "Payment" && i.@checked == true) ? "■匯票付款申請書乙份。" : "□匯票付款申請書乙份。")
                                        @(condition.singleChoice.Any(i => i.name == "Acceptance" && i.@checked == true) ? "■匯票承兌申請書乙份。" : "□匯票承兌申請書乙份。")
                                    </span>
                                    <br />
                                }
                                @foreach (var condition in Model.lcDoc.conditions.Where(c => c.name == "Invoice")) {
                                    <span>
                                        2. @(condition.used ? "■" : "□")統一發票。
                                    </span>
                                    <br />
                                }
                                @foreach (var condition in Model.lcDoc.conditions.Where(c => c.name == "OtherAppendix" && c.used == true)) {
                                    <span>
                                        3. ■其　　他
                                        <blockquote>
                                            <pre>
                                                <span class="text-blue">@condition.textArea.FirstOrDefault(a => a.name == "OtherAppendix")?.Value</span>
                                            </pre>
                                        </blockquote>
                                    </span>
                                }
                            }
                            @if (Model.lcDoc.conditions.Any(c => c.name == "OtherAppendix")) {
                                <span>上項單證應載明申請人向受益人購買下列貨品：</span>
                                <br />
                                <blockquote>
                                    <pre>
                                        <span class="text-blue">@Model.lcDoc.conditions.FirstOrDefault(c => c.name == "GoodsName")?.textArea.FirstOrDefault(a => a.name == "GoodsName" && a.Value != "~貨物名稱~")?.Value</span>
                                    </pre>
                                </blockquote>
                            }
                        </blockquote>
                    </p>
                </td>
            </tr>
            <tr>
                <td width="100%" colspan="3" bgcolor="#FFFFFF">
                    <p class="MsoNormal">
                        <span style="font-family: 新細明體">
                            <strong>三、特別指示：</strong>
                        </span>
                    </p>
                    <p class="MsoNormal" style="margin-left: 24pt; text-indent: -24pt">
                        <span style="font-family: 新細明體">
                            1. 電子押匯特別指示條款<br />
                        </span>
                        <blockquote>
                            @foreach (var clause in Model.lcDoc.conditions.Where(c => c.name == "NonCSNegotiationSpecialClause")) {
                                <div align="left">
                                    <span class="text-blue">
                                        @if (clause.used == false) {
                                            @foreach (var message in clause.prefixMessage.Skip(1).Take(clause.prefixMessage.Length - 2)) {
                                                <span>@message</span><br />
                                            }
                                        }
                                        @if (clause.used == true) {
                                            <pre>@clause.textArea.FirstOrDefault(a => a.name == "NonCSNegotiationSpecialClause")?.Value</pre>
                                        }
                                    </span>
                                </div>
                            }
                        </blockquote>
                        @if (Model.lcDoc.conditions.Any(c => c.name == "NonCSNegotiationSpecialClause" && c.used == true)) {
                            <span style="font-family: 新細明體">
                                @if (Model.lcDoc.conditions.Any(c => c.name == "PaymentTerm" && c.singleChoice.Any(i => i.name == "Sight" && i.@checked == true))) {
                                    @foreach (var condition in Model.lcDoc.conditions.Where(c => c.name == "IsBatchDeliverGoods")) {
                                        <span>
                                            2. 分批交貨：
                                            @(condition.singleChoice.Any(i => i.name == "Yes" && i.@checked == true) ? "■可以。 □不可以。" : "□可以。 ■不可以。")
                                            (未填者視為得分批交貨)
                                        </span>
                                        <br />
                                    }
                                    @foreach (var condition in Model.lcDoc.conditions.Where(c => c.name == "LastDateOfDelivery")) {
                                        <span>
                                            3. 最後交貨日期：
                                            民國
                                            <span class="text-blue">
                                                @(condition.textBlank.FirstOrDefault(b => b.name == "LastDateOfDelivery")?.Value != null ?
                                                    (int.Parse(condition.textBlank.FirstOrDefault(b => b.name == "LastDateOfDelivery")?.Value.Substring(0, 4)) - 1911).ToString() : "")
                                            </span> 年
                                            <span class="text-blue">
                                                @condition.textBlank.FirstOrDefault(b => b.name == "LastDateOfDelivery")?.Value.Substring(5, 2)
                                            </span> 月
                                            <span class="text-blue">
                                                @condition.textBlank.FirstOrDefault(b => b.name == "LastDateOfDelivery")?.Value.Substring(8, 2)
                                            </span> 日 (未填者自開狀日起三個月視為最後交貨日)
                                        </span>
                                        <br />
                                    }
                                    @foreach (var condition in Model.lcDoc.conditions.Where(c => c.name == "OtherSpecialClause" && c.used == true)) {
                                        <span>
                                            4. 其他：
                                            <blockquote>
                                                <pre>@condition.textArea.FirstOrDefault(a => a.name == "OtherSpecialClause")?.Value</pre>
                                            </blockquote>
                                        </span>
                                    }
                                }
                            </span>
                        }
                    </p>
                </td>
            </tr>
            <tr>
                <td width="100%" colspan="3" bgcolor="#FFFFFF">
                    <table class="text" border="0">
                        <tr>
                            <td>
                                <table border="0" cellpadding="2" cellspacing="0" class="contant">
                                    <tr>
                                        <td valign="top" nowrap="nowrap">利率約款：</td>
                                        <td>貴行依本申請書開發信用狀所墊付之款項，申請人同意依貴我雙方所訂之利率訂價方式，按月計付利息。</td>
                                    </tr>
                                    <tr>
                                        <td nowrap="nowrap" colspan="2">
                                            新臺幣短期放款計期方式：按日計息，以每年365天為利息計算基礎，逢閏年時亦同。利率 = 本金餘額 × 年利率 × 1/365 × 計息天數。
                                        </td>
                                    </tr>
                                    <tr>
                                        <td nowrap="nowrap" colspan="2">
                                    手續費約款：申請人同意貴行目前所訂相關費用之收費標準，且同意貴行得隨時調整，但應於調整前以顯著方式於營業場所或網站上公開揭示，另(一)貴                        <br />
                                    行依本申請書開發「利息及承兌手續費由賣方負擔」之遠期信用狀，如於信用狀有效期限屆滿而受益人未向貴行辦理提示請求承兌或申請人申請註銷信用                        <br />
                                    狀時，申請人同意依開狀金額，視信用狀有效期限以三個月為一期(未滿三個月者視為一期)，按年率0.1%補繳開狀手續費。(二)貴行依本申請書開發「利<br />
                                    息由買方負擔」之遠期信用狀，如有下列情形之一者，申請人同意依押匯金額及信用狀有效期限(3個月為一期，未滿3個月者，視為一期)，按年率0.1%<br />
                                    補繳開狀手續費，補繳金額最低為新臺幣1,000元：1.受益人未押匯或押匯後，申請人立即還款而未向貴行借款者。2.申請人提前清償借款，其原開狀手續<br />
                                    費加計利息(分批押匯改貸，以第一筆押匯金額計算)合計低於新臺幣1,000元者。
                                                    </td>
                                    </tr>
                                    <!-- ...existing code for additional rows... -->
                                </table>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="3" bgcolor="#FFFFFF">
                    <p>申請人：
                        @if (!string.IsNullOrEmpty(Model.LcDoc.Applicant.Name))
                        {
                            <font color="#0000ff">
                                @Model.LcDoc.Applicant.Name
                            </font>
                        } (請蓋原留印鑑)
                    </p>
                </td>
                <td width="10%" align="center" rowspan="2"></td>
                    <img border="0" src="../images/cds.gif"/>
                    <div align="right" id="cipher" onClick="showCipher();">
                    </div>
                </td>
            </tr>
            <tr>
                <td width="100%" colspan="3" bgcolor="#FFFFFF">

                </td>
            </tr>
        </tbody>
    </table>
    @* Hidden input element *@
    <input type="hidden" name="LOAN_RATE_XML_BAK" value="none" />

    @* Loan data table *@
    <table style="width: 100%; border: 0; cellpadding: 6; cellspacing: 1; background-color: #000;" class="text">
        <tr>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">國內信用狀額(限)度</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.limitAmount</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">國內信用狀墊款餘額(含本件)</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.advanceBalance</td>
        </tr>
        <tr>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">國內信用狀所屬分類額(限)度</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.lcAmount</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">國內信用狀所屬分類額(限)度墊款餘額(含本件)</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.availableAmount</td>
        </tr>
        <tr>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">擔保條件</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">
                <pre>@Model.loanData.condition</pre>
            </td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">額(限)度到期日</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.expiry</td>
        </tr>
        <tr>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">存入保證金比率(%)</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.rate</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">承兌手續費</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.acceptExpense</td>
        </tr>
        <tr>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">開狀手續費</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.lcExpense</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">放款帳號</td>
            <td style="width: 20%; font-family: 新細明體; background-color: #FFF;">@Model.loanData.account</td>
        </tr>
    </table>
</body>
</html>
